<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Vikram B. Baliga" />

<meta name="date" content="2021-05-04" />

<title>Analyzing work loop experiments in workloopR</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Analyzing work loop experiments in workloopR</h1>
<h4 class="author">Vikram B. Baliga</h4>
<h4 class="date">2021-05-04</h4>



<p>The function <code>analyze_workloop()</code> in <code>workloopR</code> allows users to evaluate the mechanical work and power output of a muscle they have investigated through work loop experiments.</p>
<p>To demonstrate <code>analyze_workloop()</code>, we will first load <code>workloopR</code> and use example data provided with the package. We’ll also load a couple packages within the <code>tidyverse</code> to help with data wrangling and plotting.</p>
<div id="load-packages-and-data" class="section level2">
<h2>Load packages and data</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(workloopR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
</div>
<div id="visualize" class="section level2">
<h2>Visualize</h2>
<p>We’ll now import the <code>workloop.ddf</code> file included with <code>workloopR</code>. Because this experiment involved using a gear ratio of 2, we’ll use <code>fix_GR()</code> to also implement this correction.</p>
<p>Ultimately, an object of classes <code>workloop</code>, <code>muscle_stim</code>, and <code>data.frame</code> is produced. <code>muscle_stim</code> objects are used throughout <code>workloopR</code> to help with data formatting and error checking across functions. Additionally setting the class to <code>workloop</code> allows our functions to understand that the data have properties that other experiment types (twitch, tetanus) do not.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The file workloop.ddf is included and therefore can be accessed via</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">## system.file(&quot;subdirectory&quot;,&quot;file_name&quot;,&quot;package&quot;) . We&#39;ll then use</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## read_ddf() to import it, creating an object of class &quot;muscle_stim&quot;.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## fix_GR() multiplies Force by 2 and divides Position by 2</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>workloop_dat <span class="ot">&lt;-</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.file</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;extdata&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;workloop.ddf&quot;</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">package =</span> <span class="st">&#39;workloopR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_ddf</span>(<span class="at">phase_from_peak =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_GR</span>(<span class="at">GR =</span> <span class="dv">2</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(workloop_dat)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Workloop Data: 3 channels recorded over 0.3244s</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; File ID: workloop.ddf</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mod Time (mtime): 2021-05-04 18:12:35</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sample Frequency: 10000Hz</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data.frame Columns: </span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Position (mm)</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Force (mN)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Stim (TTL)</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stimulus Offset: 0.012s</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stimulus Frequency: 300Hz</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stimulus Width: 0.2ms</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stimulus Pulses: 4</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gear Ratio: 2</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cycle Frequency: 28Hz</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total Cycles (L0-to-L0): 6</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Amplitude: 1.575mm</span></span></code></pre></div>
<p>Running <code>summary()</code> on a `muscle_stim shows a handy summary of file properties, data, and experimental parameters.</p>
<p>Let’s plot Time against Force, Position, and Stimulus (Stim) to visualize the time course of the work loop experiment.</p>
<p>To get them all plotted in the same figure, we’ll transform the data as they are being plotted. Please note that this is for aesthetic purposes only - the underlying data will not be changed after the plotting is complete.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>scale_position_to_force <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>workloop_dat <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set the x axis for the whole plot</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time)) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a line for force</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Force, <span class="at">color =</span> <span class="st">&quot;Force&quot;</span>), </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a line for Position, scaled to approximately the same range as Force</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Position <span class="sc">*</span> scale_position_to_force, <span class="at">color =</span> <span class="st">&quot;Position&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For stim, we only want to plot where stimulation happens, so we filter the data</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;Stim&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> <span class="fu">filter</span>(workloop_dat, Stim <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Next we add the second y-axis with the corrected units</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">/</span> scale_position_to_force, <span class="at">name =</span> <span class="st">&quot;Position (mm)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Finally set colours, labels, and themes</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FC4E2A&quot;</span>, <span class="st">&quot;#4292C6&quot;</span>, <span class="st">&quot;#373737&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Force (mN)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Time (secs)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Parameter:&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Time course of </span><span class="sc">\n</span><span class="st"> work loop experiment&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>There’s a lot to digest here. The blue trace shows the change in length of the muscle via cyclical, sinusoidal changes to Position. The dark gray Stim dots show stimulation on a off vs. on basis. Stimulus onset is close to when the muscle is at L0 and the stimulator zapped the muscle four times in pulses of 0.2 ms width at 300 Hz. The resulting force development is shown in red. These cycles of length change and stimulation occurred a total of 6 times (measuring L0-to-L0).</p>
</div>
<div id="select-cycles" class="section level2">
<h2>Select cycles</h2>
<p>We are now ready to run the <code>select_cycles()</code> function. This function subsets the data and labels each cycle in prep for our <code>analyze_workloop()</code> function.</p>
<p>In many cases, researchers are interested in using the final 3 cycles for analyses. Accordingly, we’ll set the <code>keep_cycles</code> parameter to <code>4:6</code>.</p>
<p>One thing to pay heed to is the cycle definition, encoded as <code>cycle_def</code> within the arguments of <code>select_cycles()</code>. There are three options for how cycles can be defined and are named based on the starting (and ending) points of the cycle. We’ll use the L0-to-L0 option, which is encoded as <code>lo</code>.</p>
<p>The function internally performs butterworth filtering of the Position data via <code>signal::butter()</code>. This is because Position data are often noisy, which makes assessing true peak values difficult. The default values of <code>bworth_order = 2</code> and <code>bworth_freq = 0.05</code> work well in most cases, but we recommend you please plot your data and assess this yourself.</p>
<p>We will keep things straightforward for now so that we can proceed to the analytical stage. Please see the final section of this vignette for more details on using <code>select_cycles()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Select cycles</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>workloop_selected <span class="ot">&lt;-</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  workloop_dat <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_cycles</span>(<span class="at">cycle_def=</span><span class="st">&quot;lo&quot;</span>, <span class="at">keep_cycles =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(workloop_selected)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Workloop Data: 4 channels recorded over 0.1086s</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; File ID: workloop.ddf</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mod Time (mtime): 2021-05-04 18:12:35</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sample Frequency: 10000Hz</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data.frame Columns: </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Position (mm)</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Force (mN)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Stim (TTL)</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Cycle (letters)</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stimulus Offset: 0.012s</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stimulus Frequency: 300Hz</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stimulus Width: 0.2ms</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stimulus Pulses: 4</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gear Ratio: 2</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cycle Frequency: 28Hz</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total Cycles (L0-to-L0): 6</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cycles Retained: 3</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Amplitude: 1.575mm</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(workloop_selected, <span class="st">&quot;retained_cycles&quot;</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 4 5 6</span></span></code></pre></div>
<p>The <code>summary()</code> function now reflects that 3 cycles of the original 6 have been retained, and getting the <code>&quot;retained_cycles&quot;</code> attribute shows that these cycles are 4, 5, and 6 from the original data.</p>
<p>To avoid confusion in numbering schemes between the original data and the new object, once <code>select_cycles()</code> has been used we label cycles by letter. So, cycle 4 is now “a”, 5 is “b” and 6 is “c”.</p>
</div>
<div id="plot-the-work-loop-cycles" class="section level2">
<h2>Plot the work loop cycles</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>workloop_selected <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Position, <span class="at">y =</span> Force)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Force (mN)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Position (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Work loop&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="basics-of-analyze_workloop" class="section level2">
<h2>Basics of <code>analyze_workloop()</code></h2>
<p>Now we’re ready to use <code>analyze_workloop()</code>.</p>
<p>Again, running <code>select_cycles()</code> beforehand was necessary, so we will switch to using <code>workloop_selected</code> as our data object.</p>
<p>Within <code>analyze_workloop()</code>, the <code>GR =</code> option allows for the gear ratio to be corrected if it hasn’t been already. But because we already ran <code>fix_GR()</code> to correct the gear ratio to 2, we will not need to use it here again. So, this for this argument, we will use <code>GR = 1</code>, which keeps the data as they are. Please take care to ensure that you do not overcorrect for gear ratio by setting it multiple times. Doing so induces multiplicative changes. E.g. setting <code>GR = 3</code> on an object and then setting <code>GR = 3</code> again produces a gear ratio correction of 9.</p>
<div id="using-the-default-simplify-false-version" class="section level3">
<h3>Using the default <code>simplify = FALSE</code> version</h3>
<p>The argument <code>simplify =</code> affects the output of the <code>analyze_workloop()</code> function. We’ll first take a look at the organization of the “full” version, i.e. keeping the default <code>simplify = FALSE</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Run the analyze_workloop() function</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>workloop_analyzed <span class="ot">&lt;-</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  workloop_selected <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_workloop</span>(<span class="at">GR =</span> <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Produces a list of objects. </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The print method gives a simple output:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>workloop_analyzed</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; File ID: workloop.ddf</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cycles: 3 cycles kept out of 6</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Work: 0.0033 J</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Power: 0.09589 W</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="do">## How is the list organized?</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(workloop_analyzed)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;cycle_a&quot; &quot;cycle_b&quot; &quot;cycle_c&quot;</span></span></code></pre></div>
<p>This produces an <code>analyzed_workloop</code> object that is essentially a <code>list</code> that is organized by cycle. Within each of these, time-course data are stored as a <code>data.frame</code> and important metadata are stored as attributes.</p>
<p>Users may typically want work and net power from each cycle. Within the <code>analyzed_workloop</code> object, these two values are stored as attributes: <code>&quot;work&quot;</code> (in J) and <code>&quot;net_power&quot;</code> (in W). To get them for a specific cycle:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## What is work for the second cycle?</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(workloop_analyzed<span class="sc">$</span>cycle_b, <span class="st">&quot;work&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.003282334</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## What is net power for the third cycle?</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(workloop_analyzed<span class="sc">$</span>cycle_c, <span class="st">&quot;net_power&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.09812219</span></span></code></pre></div>
<p>To see how e.g. the first cycle is organized:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(workloop_analyzed<span class="sc">$</span>cycle_a)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Classes &#39;workloop&#39;, &#39;muscle_stim&#39; and &#39;data.frame&#39;:  357 obs. of  9 variables:</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Time            : num  0.119 0.119 0.119 0.12 0.12 ...</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Position        : num  0.33 0.359 0.389 0.414 0.441 ...</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Force           : num  1708 1718 1725 1734 1744 ...</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Stim            : int  1 1 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Cycle           : chr  &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; ...</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Inst_Velocity   : num  NA -0.292 -0.292 -0.252 -0.271 ...</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Filt_Velocity   : num  NA -0.143 -0.158 -0.172 -0.185 ...</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Inst_Power      : num  NA -0.246 -0.272 -0.298 -0.322 ...</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Percent_of_Cycle: num  0 0.281 0.562 0.843 1.124 ...</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;stimulus_frequency&quot;)= int 300</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;cycle_frequency&quot;)= int 28</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;total_cycles&quot;)= num 6</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;cycle_def&quot;)= chr &quot;lo&quot;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;amplitude&quot;)= num 1.57</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;phase&quot;)= num -24.9</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;position_inverted&quot;)= logi FALSE</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;units&quot;)= chr [1:8] &quot;s&quot; &quot;mm&quot; &quot;mN&quot; &quot;TTL&quot; ...</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;sample_frequency&quot;)= num 10000</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;header&quot;)= chr [1:4] &quot;Sample Frequency (Hz): 10000&quot; &quot;Reference Area: NaN sq. mm&quot; &quot;Reference Force: NaN mN&quot; &quot;Reference Length: NaN mm&quot;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;units_table&quot;)=&#39;data.frame&#39;:  10 obs. of  5 variables:</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ Channel: chr [1:10] &quot;AI0&quot; &quot;AI1&quot; &quot;AI2&quot; &quot;AI3&quot; ...</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ Units  : chr [1:10] &quot;mm&quot; &quot;mN&quot; &quot;TTL&quot; &quot;&quot; ...</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ Scale  : num [1:10] 1 500 0.2 0 0 0 0 0 1 500</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ Offset : num [1:10] 0 0 0 0 0 0 0 0 0 0</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ TADs   : num [1:10] 0 0 0 0 0 0 0 0 0 0</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;protocol_table&quot;)=&#39;data.frame&#39;:   4 obs. of  5 variables:</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ Wait.s     : num [1:4] 0 0.01 0 0.1</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ Then.action: chr [1:4] &quot;Stimulus-Train&quot; &quot;Sine Wave&quot; &quot;Stimulus-Train&quot; &quot;Stop&quot;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ On.port    : chr [1:4] &quot;Stimulator&quot; &quot;Length Out&quot; &quot;Stimulator&quot; &quot;&quot;</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ Units      : chr [1:4] &quot;.012, 300, 0.2, 4, 28&quot; &quot;28,3.15,6&quot; &quot;0,0,0,0,0&quot; &quot;&quot;</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ Parameters : logi [1:4] NA NA NA NA</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;stim_table&quot;)=&#39;data.frame&#39;:   2 obs. of  5 variables:</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ offset         : num [1:2] 0.012 0</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ frequency      : int [1:2] 300 0</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ width          : num [1:2] 0.2 0</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ pulses         : int [1:2] 4 0</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ cycle_frequency: int [1:2] 28 0</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;stimulus_pulses&quot;)= int 4</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;stimulus_offset&quot;)= num 0.012</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;stimulus_width&quot;)= num 0.2</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;gear_ratio&quot;)= num 2</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;file_id&quot;)= chr &quot;workloop.ddf&quot;</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;mtime&quot;)= POSIXct[1:1], format: &quot;2021-05-04 18:12:35&quot;</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;retained_cycles&quot;)= int [1:3] 4 5 6</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;work&quot;)= num 0.00301</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;net_power&quot;)= num 0.0909</span></span></code></pre></div>
<p>Within each cycle’s <code>data.frame</code>, the usual <code>Time</code>, <code>Position</code>, <code>Force</code>, and <code>Stim</code> are stored. <code>Cycle</code>, added via <code>select_cycles()</code>, denotes cycle identity and <code>Percent_of_Cycle</code> displays time as a percentage of that particular cycle.</p>
<p><code>analyze_workloop()</code> also computes instantaneous velocity (<code>Inst_Velocity</code>) which can sometimes be noisy, leading us to also apply a butterworth filter to this velocity (<code>Filt_Velocity</code>). See the function’s help file for more details on how to tweak filtering. The time course of power (instantaneous power) is also provided as <code>Inst_Power</code>.</p>
<p>Each of these variables can be plot against Time to see the time-course of that variable’s change over the cycle. For example, we will plot instantaneous force in cycle b:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>workloop_analyzed<span class="sc">$</span>cycle_b <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Percent_of_Cycle, <span class="at">y =</span> Inst_Power)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Instantaneous Power (W)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Percent cycle&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Instantaneous power </span><span class="sc">\n</span><span class="st"> during cycle b&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="setting-simpilfy-true-in-the-analyze_workloop-function" class="section level3">
<h3>Setting <code>simpilfy = TRUE</code> in the <code>analyze_workloop()</code> function</h3>
<p>If you simply want work and net power for each cycle without retaining any of the time-course data, set <code>simplify = TRUE</code> within <code>analyze_workloop()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>workloop_analyzed_simple <span class="ot">&lt;-</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  workloop_selected <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_workloop</span>(<span class="at">GR =</span> <span class="dv">1</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Produces a simple data.frame:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>workloop_analyzed_simple</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Cycle        Work  Net_Power</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; a     A 0.003007098 0.09085517</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b     B 0.003282334 0.09870268</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; c     C 0.003601049 0.09812219</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(workloop_analyzed_simple)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    3 obs. of  3 variables:</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Cycle    : chr  &quot;A&quot; &quot;B&quot; &quot;C&quot;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Work     : num  0.00301 0.00328 0.0036</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Net_Power: num  0.0909 0.0987 0.0981</span></span></code></pre></div>
<p>Here, work (in J) and net power (in W) are simply returned in a <code>data.frame</code> that is organized by cycle. No other attributes are stored.</p>
</div>
</div>
<div id="more-on-cycle-definitions-in-select_cycles" class="section level2">
<h2>More on cycle definitions in <code>select_cycles()</code></h2>
<p>As noted above, there are three options for cycle definitions within <code>select_cycles()</code>, encoded as <code>cycle_def</code>. The three options for how cycles can be defined are named based on the starting (and ending) points of the cycle: L0-to-L0 (<code>lo</code>), peak-to-peak (<code>p2p</code>), and trough-to-trough (<code>t2t</code>).</p>
<p>We highly recommend that you plot your Position data after using <code>select_cycles()</code>. The <code>pracma::findpeaks()</code> function work for most data (especially sine waves), but it is conceivable that small, local ‘peaks’ may be misinterpreted as a cycle’s true minimum or maximum.</p>
<p>We also note that edge cases (i.e. the first cycle or the final cycle) may also be subject to issues in which the cycles are not super well defined via an automated algorithm.</p>
<p>Below, we will plot a couple case examples to show what we generally expect. We recommend plotting your data in a similar fashion to verify that <code>select_cycles()</code> is behaving in the way you expect.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Select cycles 4:6 using lo</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>workloop_dat <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_cycles</span>(<span class="at">cycle_def=</span><span class="st">&quot;lo&quot;</span>, <span class="at">keep_cycles =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Position)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Select cycles 4:6 using p2p</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>workloop_dat <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_cycles</span>(<span class="at">cycle_def=</span><span class="st">&quot;p2p&quot;</span>, <span class="at">keep_cycles =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Position)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## here we see that via &#39;p2p&#39; the final cycle is ill-defined because the return</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## to L0 is considered a cycle. Using a p2p definition, what we actually want is</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## to use cycles 3:5 to get the final 3 full cycles:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>workloop_dat <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_cycles</span>(<span class="at">cycle_def=</span><span class="st">&quot;p2p&quot;</span>, <span class="at">keep_cycles =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Position)) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="do">## this difficulty in defining cycles may be more apparent by first plotting the </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## cycles 1:6, e.g.</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>workloop_dat <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_cycles</span>(<span class="at">cycle_def=</span><span class="st">&quot;p2p&quot;</span>, <span class="at">keep_cycles =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Position)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
